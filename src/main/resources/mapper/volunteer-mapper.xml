<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="volunteerMapper">

	<insert id="insertSchedule">
		insert into volunteer_add
		values(SEQ_VOL_SCH.NEXTVAL, #{volContent},#{volStart},#{volEnd},#{volMax},default,default)
	</insert>
	
	<resultMap type="VolunteerSchedule" id="ScheduleResultSet">
		<id property="volAddNum" column ="vol_add_num" />
		<result property="volContent" column="vol_content" />
		<result property="volStart" column="vol_start" />
		<result property="volEnd" column="vol_end" />
		<result property="volMax" column="vol_max" />
		<result property="volStatus" column="vol_status" />
		<result property="volCur" column="vol_cur" />
	</resultMap>
	
	<select id="getSchedule" resultMap = "ScheduleResultSet">
		select vol_add_num, vol_content, vol_start, vol_end, vol_max, vol_status
		from volunteer_add
	</select>
	
	<insert id="insertEntry">
		insert into volunteer
		values(SEQ_ENTRY.NEXTVAL, default, #{userID}, #{vlNum2}, #{vlPhone}, #{userName})
	</insert>
	
	
	<select id="checkMax" resultType="_int">
		SELECT COUNT(*)
		FROM VOLUNTEER
		JOIN VOLUNTEER_ADD ON VOL_ADD_NUM = VL_NUM2
		WHERE VOL_MAX > (select count(*)
		                 FROM VOLUNTEER
		                 WHERE VL_NUM2 = #{vlNum2} AND VL_STATUS = 'Y')
	</select>
	
	<resultMap type="Volunteer" id="volResultSet">
		<id property="vlNum" column ="vl_num" />
		<result property="vlStatus" column="vl_status" />
		<result property="userID" column="user_id" />
		<result property="vlNum2" column="vl_num2" />
		<result property="vlPhone" column="vl_phone" />
		<result property="userName" column="user_name" />
	</resultMap>
</mapper>
